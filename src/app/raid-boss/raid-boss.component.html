<div fxFlex fxLayout="column">
  <topbar [whichToPrint]="whichToPrint" [previusUrl]="previusUrl" [isSuperUser]="raidBosser"></topbar>
  <div fxFlex fxLayout="column">
    <mat-form-field style="padding:0em 1em;">
      <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Search by name or level">
    </mat-form-field>
    <mat-table [dataSource]="actualDisplay" class="example-container mat-elevation-z8" matSort>
      <!-- Position Column -->
      <ng-container matColumnDef="name">
        <mat-header-cell *matHeaderCellDef mat-sort-header color="primary"> Name </mat-header-cell>
        <mat-cell *matCellDef="let element">
          {{element.name}}
        </mat-cell>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="level">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Level </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{element.level}} </mat-cell>
      </ng-container>

      <!-- Symbol Column -->
      <ng-container matColumnDef="windowStart">
        <mat-header-cell *matHeaderCellDef> Window Start </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div *ngIf="element.isAlive != 'AAUNKNOWN'">{{element.windowStarts | date: 'MMM d, y, HH:mm:ss'}} </div>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="windowEnd">
        <mat-header-cell *matHeaderCellDef> Window End </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div *ngIf="element.isAlive != 'AAUNKNOWN'">{{element.windowEnds | date : 'MMM d, y, HH:mm:ss'}} </div>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="state">
        <mat-header-cell *matHeaderCellDef> State </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <mat-icon *ngIf="element.isAlive === 'DEAD'" [matTooltip]="displayingView[element.isAlive]">
            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
              <path fill="#000000"
                d="M12,2A9,9 0 0,0 3,11C3,14.03 4.53,16.82 7,18.47V22H9V19H11V22H13V19H15V22H17V18.46C19.47,16.81 21,14 21,11A9,9 0 0,0 12,2M8,11A2,2 0 0,1 10,13A2,2 0 0,1 8,15A2,2 0 0,1 6,13A2,2 0 0,1 8,11M16,11A2,2 0 0,1 18,13A2,2 0 0,1 16,15A2,2 0 0,1 14,13A2,2 0 0,1 16,11M12,14L13.5,17H10.5L12,14Z" />
            </svg>
          </mat-icon>
          <mat-icon *ngIf="element.isAlive === 'AAUNKNOWN'" [matTooltip]="displayingView[element.isAlive]">
            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
              <path fill="#000000"
                d="M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z" />
            </svg>
          </mat-icon>
          <mat-icon *ngIf="element.isAlive === 'ALIVE'" [matTooltip]="displayingView[element.isAlive]">
            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
              <path fill="#FFFFFF"
                d="M16.5,5.5A2,2 0 0,0 18.5,3.5A2,2 0 0,0 16.5,1.5A2,2 0 0,0 14.5,3.5A2,2 0 0,0 16.5,5.5M12.9,19.4L13.9,15L16,17V23H18V15.5L15.9,13.5L16.5,10.5C17.89,12.09 19.89,13 22,13V11C20.24,11.03 18.6,10.11 17.7,8.6L16.7,7C16.34,6.4 15.7,6 15,6C14.7,6 14.5,6.1 14.2,6.1L9,8.3V13H11V9.6L12.8,8.9L11.2,17L6.3,16L5.9,18L12.9,19.4M4,9A1,1 0 0,1 3,8A1,1 0 0,1 4,7H7V9H4M5,5A1,1 0 0,1 4,4A1,1 0 0,1 5,3H10V5H5M3,13A1,1 0 0,1 2,12A1,1 0 0,1 3,11H7V13H3Z" />
            </svg>
          </mat-icon>
          <mat-icon *ngIf="element.isAlive === 'ONWINDOW'" [matTooltip]="displayingView[element.isAlive]">
            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
              <path fill="#000000" d="M4,4H20V20H4V4M6,8V18H18V8H6Z" />
            </svg>
          </mat-icon>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="more">
        <mat-header-cell *matHeaderCellDef></mat-header-cell>
        <mat-cell *matCellDef="let element;">
          <div fxShow fxHide.xs="true">
            <button [disabled]="!raidBosser" mat-raised-button color="accent"
              (click)="handleRowClick(element.raidBossId)">
              <mat-icon>
                <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                  <path fill="#000000"
                    d="M21,10.12H14.22L16.96,7.3C14.23,4.6 9.81,4.5 7.08,7.2C4.35,9.91 4.35,14.28 7.08,17C9.81,19.7 14.23,19.7 16.96,17C18.32,15.65 19,14.08 19,12.1H21C21,14.08 20.12,16.65 18.36,18.39C14.85,21.87 9.15,21.87 5.64,18.39C2.14,14.92 2.11,9.28 5.62,5.81C9.13,2.34 14.76,2.34 18.27,5.81L21,3V10.12M12.5,8V12.25L16,14.33L15.28,15.54L11,13V8H12.5Z" />
                </svg>
              </mat-icon>Update TOD
            </button>
          </div>
          <div fxHide fxShow.xs="true">
            <button mat-icon-button [matMenuTriggerFor]="menu">
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #menu="matMenu" xPosition="before">
              <button [disabled]="!raidBosser" mat-menu-item color="accent" (click)="handleRowClick(element.raidBossId)"
                style="background-color:#00E676">
                <mat-icon>
                  <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                    <path fill="#000000"
                      d="M21,10.12H14.22L16.96,7.3C14.23,4.6 9.81,4.5 7.08,7.2C4.35,9.91 4.35,14.28 7.08,17C9.81,19.7 14.23,19.7 16.96,17C18.32,15.65 19,14.08 19,12.1H21C21,14.08 20.12,16.65 18.36,18.39C14.85,21.87 9.15,21.87 5.64,18.39C2.14,14.92 2.11,9.28 5.62,5.81C9.13,2.34 14.76,2.34 18.27,5.81L21,3V10.12M12.5,8V12.25L16,14.33L15.28,15.54L11,13V8H12.5Z" />
                  </svg>
                </mat-icon>Update TOD
              </button>
              <mat-divider style="background-color:black;"></mat-divider>
              <button [fxShow]="element.isAlive != 'AAUNKNOWN'" [disabled]="!raidBosser"
                style="background-color:#00E676; text-align: center;" mat-menu-item color="accent"
                (click)="handleUnknowClick(element.raidBossId)">
                Unknown TOD
              </button>
            </mat-menu>
          </div>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="unknown">
        <mat-header-cell *matHeaderCellDef fxShow fxHide.xs="true"></mat-header-cell>
        <mat-cell *matCellDef="let element" fxShow fxHide.xs="true">
          <div *ngIf="element.isAlive != 'AAUNKNOWN'">
            <button [disabled]="!raidBosser" mat-raised-button color="accent"
              (click)="handleUnknowClick(element.raidBossId)">
              Unknown TOD
            </button>
          </div>
        </mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row [ngClass]="row.isAlive" *matRowDef="let row; columns: displayedColumns;"></mat-row>
    </mat-table>
  </div>